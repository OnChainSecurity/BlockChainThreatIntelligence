{
    "threat_intelligence": {
        "url": "https://x.com/ShieldifySec/status/1846480437356417129",
        "timestamp": "2024-10-16 00:00:00",
        "original_content": "`getAssetPrice()` function just returns the Asset/ETH exchange rate. But the\ninteresting point is inside `getRSETHPrice()`:\n\n[![Image](https://pbs.twimg.com/media/GaADyMEXAAAvr_X?format=jpg&name=medium)](/ShieldifySec/status/1846480437356417129/photo/1)\n\nFirstly, it calculates how much ETH is in the vault in total by converting\neach asset into ETH. The important thing to note here is how we get the amount\nof assets the vault has. When we go into getTotalAssetDeposits(), it directs\nus to getAssetDistributionData() where it uses balanceOf to get the amount of\ndeposit assets inside the vault. Secondly, getRSETHPrice divides it by the\nrsETH\u2019s total supply. And as you can see if rsETH total supply is 0, then the\nprice returned is 1 ether. But, where are the inflation attacks and rounding\ndown precision loss exactly? Let\u2019s look at an example. We\u2019ve just deployed\nWETH/rsETH vault and Bob wants to deposit 10 WETH. The balances are the\nfollowing: balanceOfWeth = 0. totalSupplyRsETH = 0. Alice sees Bob\u2019s\ntransaction and front runs it with depositing 1 wei of WETH. Since there\u2019s no\nrsETH minted, it returns the price of 1 ether and we have the following\nequation:\n\n[![Image](https://pbs.twimg.com/media/GaAD8JzX0AAm9k6?format=png&name=medium)](/ShieldifySec/status/1846480437356417129/photo/2)\n\nAlice receives 1 wei of rsETH. Now she front-runs Bob again and directly\ntransfers 10 WETH into the contract. And when Bob\u2019s transaction goes through,\nthe balanceOfWeth equals 10+1 wei WETH and totalSupplyRsETH equals 1 wei.\nLet\u2019s look at the result of his deposit: And due to rounding down in Solidity,\nBob got minted 0 shares and now Alice can withdraw 20 WETH + 1 wei. The next\nquestion we\u2019re going to answer is how to save users and protocols from\ninflation attacks.\n\n[![Image](https://pbs.twimg.com/media/GaAECTeXsAAr3u5?format=png&name=medium)](/ShieldifySec/status/1846480437356417129/photo/3)"
    }
}