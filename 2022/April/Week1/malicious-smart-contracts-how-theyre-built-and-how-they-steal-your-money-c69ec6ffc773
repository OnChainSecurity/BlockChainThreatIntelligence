{
    "threat_intelligence": {
        "url": "https://blog.harpie.io/malicious-smart-contracts-how-theyre-built-and-how-they-steal-your-money-c69ec6ffc773",
        "timestamp": "2022-04-02 00:00:00",
        "original_content": "Malicious smart contracts: how they\u2019re built, and how they steal your money\nDaniel Chong\nThe Harpie Blog\nDaniel Chong\n\n\u00b7\nFollow\n\nPublished in\nThe Harpie Blog\n\n\u00b7\n6 min read\n\u00b7\nApr 2, 2022\n33\n\n\n\n\n\n\n\nFor many people that buy, trade, and sell crypto, smart contracts have an air of mystique around them. Everyone has used one, but not many people have seen one, and even fewer people know how to build one.\n\nThis experience gap allows savvy hackers to trick people out of their hard-earned digital money. This article goes over malicious smart contracts: how they work, how to spot one, and how to avoid them altogether.\n\nWhat is a malicious smart contract?\nMalicious smart contracts are smart contracts that attempt to steal or misuse deposited funds. Malicious smart contracts come in many variations, so I\u2019ll give a couple of examples:\n\nApproval contracts that give a hacker access to a certain token you own\nLiquidity pool smart contracts that never actually let you withdraw your money\nDeposit contracts that sends your crypto over to a hacker\u2019s wallet\nMalicious contracts are the execution layers of crypto smart contract scams. These scams rely on social engineering to get you to sign their smart contracts, and then execute the theft once the smart contract is signed.\n\nA famous example of one of these crypto smart contract scams was the $1.7m February 2022 OpenSea phishing attack.\n\n\nBy opening up this phishing email, users were asked to sign a malicious smart contract that transferred all their NFTs to a hacker\u2019s address.\n\nWho actually falls for these?\nIf you\u2019re a tech-savvy web3 veteran, you might be wondering, \"who actually falls for these scams?\" The truth is that it\u2019s difficult to detect malicious smart contracts, and in some cases, even mathematically impossible.\n\n\nYou really don\u2019t know what a smart contract holds.\nThere\u2019s a theorem in computer science called Rice\u2019s theorem, which essentially states that properties of programs can never be algorithmically determined.\n\nThe consequence of Rice\u2019s theorem is that we\u2019ll never be sure if the contracts we\u2019re interacting with are malicious.\n\nWe will never be sure if the contracts we\u2019re interacting with are malicious or not.\n\nFalling for a malicious contract can happen to anyone. And even though most malicious contracts are fairly easy to spot to a well-informed eye, there are ways to obfuscate code such that the behavior of the smart contract is unknown. There really are no ways to fully guard yourself against malicious contracts at a programmatic level.\n\nSo\u2026 what can I do?\nThere\u2019s one main difference between web3 and web2 personal security: in web3, it only takes a single click to lose everything you own. Outside of that, web3 and web2 scams have the same two steps:\n\nSocial engineering: a person/organization will convince you to enter their website.\nPayload: the website/app has a mechanism that steals your money. In web2, that\u2019s usually a wire transfer. In web3, it\u2019s a single click of a smart contract.\nAs previously established, it\u2019s difficult (and sometimes impossible) to determine if a smart contract is malicious or not. That means that the only way to protect yourself from web3 scams is to detect and avoid the portions of the scam that lead you to sign the malicious smart contract.\n\nDetecting social engineering\nSocial engineering in web3 scamming takes many forms, but there\u2019s a few categories to watch out for.\n\nGiveaway: a scammer will tell you that you\u2019re eligible for a giveaway, and ask you to sign a smart contract on their payload website.\n\nA typical giveaway scam. Names hidden because I don\u2019t want to promote scams on my Medium :P\nManipulation: a scammer will pose as a \"trading buddy,\" letting you know about profitable new projects they come across. Eventually, they lead you to a payload website of their own creation.\nImpersonation: a scammer will pose as a MetaMask engineer and ask you to provide your private key, sometimes even over Twitter or Discord.\nBe wary of anyone being overly kind or supportive to you over the Internet. If it sounds too good to be true, it probably is! You cannot trust anybody, no matter who they claim to be.\n\nDetecting a payload site\nIf you somehow fall victim to social engineering without detecting it, it\u2019s not too late! Although malicious smart contracts may be difficult to detect, payload sites have some common traits that can help you detect a scam before it\u2019s too late.\n\n\n(not pictured: the website even has a https:// URL)\nThis site is an example of a payload site, and it looks relatively normal. It\u2019s a decent looking website advertising a plausible product. If you\u2019re looking very closely, you\u2019ll see a few grammatical mistakes, but nothing egregious enough to make you turn your head.\n\nScamming has evolved since the 2000s: the payload sites of today have big budgets, and are going to look convincing and professional. A general rule is that, most times, you won\u2019t know if a site is a payload unless you look outside the site. Here are the personal steps I take to determine if a site is a payload or not:\n\nLook at the URL. If it\u2019s something like asdlkjyndz242.fjk334.ru\u2026 don\u2019t proceed. Sometimes, the URL can look legitimate; for example, the above screenshot is on a .com domain and is on https.\nSearch for their social media profiles. Many of these scam sites have Twitter profiles with a few dead giveaways. The payload site above had a Twitter page with 25k (fake) followers, yet had no tweets, no Discord, & no interaction with members of its community.\nA little trick: \"[page name] scam reddit\" on Google. There will sometimes be real people commenting about the scam on Reddit\u2026 that being said, take everything you see online with a grain of salt.\nLook for content being produced by the company. Almost every legitimate crypto company has spent significant time and resources creating educational content on crypto. Try to find their blog.\nIf you\u2019ve done all of these, and no red flags go off, make a final decision on whether or not to use the site. Do a short background check on the person that referred you to the site, do your due diligence, and check once more before you click that button."
    }
}