{
    "threat_intelligence": {
        "url": "https://www.linkedin.com/posts/advait-trivedi-9738b81b5_pricemanipulation-activity-7097204573047599104-TCEv",
        "timestamp": "2023-08-14 00:00:00",
        "original_content": "\n\nType: \n#priceManipulation\n\n\nProject: Zunami Protocol\n\nDate: 14/08/23\nBlockchain: ETH\n\nProblem: Strategy calculations are based on variables, which can be manipulated.\n\nThis hack is a price manipulation attack, where there is a flawed calculation of the LP price.\nThe total USD holdings in strategy is calculated as:\nlpBalance \u00d7 lpPrice + SDT \u00d7 sdtPrice + \n_config.crv\n * crvPrice\nSo, by manipulating amount and the price of SDT token the hacker managed to gain huge profit.\n\nThe Hacker:\n1) Borrow flashloans in USDT and USDC from the UniswapV3 and Balancer.\n2) Add liquidity in the CurveFinance: Swap with 5,750,000 USDC and mint ~5,746,896 the CrvFRAX, then swap ~5,746,896 CrvFRAX for ~ 4,082,046 UZD and 1,250,000 USDC for ~791,280 UZD in the Curve.\n3) Swap 11 WETH for ~55,981 ST in the Curve, then donate all SDT (~55,598) into the\nMIMCurveStakeDag.\n4) Swap 10,000 WETH for ~58,043 SDT and 7,000,000 USDT for ~2,154 WETH in the SushiSwap. (SDT price inflated)\n5) Cache the price snapshot in the UZD via the function cacheAssetPrice (the price cached has already been manipulated)\nNote: Cause the function balance in the UZD contract relies on the incorrect price in the cache, the balance of the\nATTACKER is inflated now!\n6) Reverse all operations for manipulating the price of UZD and swap all UZD inflated to profit.\n\nDiscoverer: NaN, was hacked \nhttps://lnkd.in/d6XpiEwW\n\nHarm: 2 M $\nlink \nhttps://lnkd.in/d6giNKR8\n\n\n\n"
    }
}