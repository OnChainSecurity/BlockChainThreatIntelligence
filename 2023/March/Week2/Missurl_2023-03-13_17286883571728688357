{
    "threat_intelligence": {
        "url": "https://www.chainalysis.com/blog/euler-finance-flash-loan-attack/",
        "timestamp": "2023-03-13 00:00:00",
        "original_content": "\n\nNew updates, 4/6/23: Hacker returns stolen funds, marking one of the largest DeFi recoveries\n\n\nSeveral weeks after the $197 million Euler Finance Flash Loan Attack, the hacker returned the stolen funds and apologized through a series of encrypted messages. The hacker, who identifies as Jacob, began by sending 54,000 in ETH (3,000 on March 18 and 51,000 on March 25) to Euler and followed with 7,000 ETH and $10 million in DAI several days later. Jacob also sent ETH and DAI from these addresses, all of which Jacob funded directly:\n\n\n\n\n0x46e0Be2DF97dAc791fC8e30Cf2b2E4f58c50Cf55\n\n\n0xa1b44d4b5b4C361f51E029b81bf2Db9cF4D8e676\n\n\n0xC4e04Ac48639FF077eBb36E7cFe0C4993b7b208E\n\n\n0x8765A35394C98e81B9d56d44248E1199D8E38A4c\n\n\n0xB2698C2D99aD2c302a95A8DB26B08D17a77cedd4\n\n\n0xc66dFA84BC1B93df194bD964a41282da65D73c9a\n\n\n\n\nAs the below image demonstrates, Jacob expressed intentions to eventually return all of the funds, which Jacob \nfulfilled\n:\n\n\n\n\nSource: \nEtherscan\n\n\nThe following \nChainalysis Reactor\n graph shows the movement of funds back to Euler Finance: \n\n\n\n\nOn April 4, Euler released a \nstatement\n, announcing that the community investigation is finished and the company is developing a plan to restore user assets. \n\n\nNew updates, 3/17/23: Possible North Korean involvement\n\n\nEarly in the morning of March 17, 2023, 100 ETH stolen in the Euler Finance hack moved to an address that previously received funds stolen in the Axie Infinity Ronin Bridge hack, which was carried out by the North Korean hacking syndicate Lazarus Group.\n\n\n\n\nThis could also mean that the Euler Finance hack was also carried out by Lazarus Group. However, we can\u2019t yet know for sure \u2014 it\u2019s possible that this movement of funds was an attempt at misdirection by another hacking group. We will continue to monitor the situation and provide updates as possible.\n\n\nOriginal post: Analysis of Euler Finance flash loan attack\n\n\nOn March 13, 2023, \nEuler Finance\n, a permissionless borrowing and lending protocol on Ethereum, was the victim of a \nflash loan attack\n. Euler Finance isn\u2019t the first DeFi hack victim this year \u2014\u00a0\ndForce\n and \nPlatypus\n were similarly targeted in February \u2014 but it is unfortunately the largest. At a whopping near-$200 million loss, hackers stole funds in USDC, wrapped Bitcoin (wBTC), staked Ether (stETH), and DAI, an algorithmic stablecoin maintained by MakerDAO. A hack of this magnitude illustrates both the ongoing threats to widely used DeFi protocols and the potential hacking abuses opened up by flash loans.\u00a0\n\n\nIn this blog, we\u2019ll explore how flash loans work, how hackers stole funds from Euler Finance, and how the effects of flash loan attacks may be mitigated in the future.\u00a0\n\n\nWhat is a flash loan?\n\u00a0\n\n\nBefore analyzing the details of the Euler hack, it is important to understand how flash loans typically work. Flash loans are executed by smart contracts and enable participants to quickly borrow funds \nwithout the need for collateral\n. However, these loans must be repaid in full within the same transaction, or else the entire transaction, including the loan itself, will be reversed. Flash loans are attractive for DeFi traders looking to \nmaximize arbitrage\n opportunities. They are also commonly used for \nswapping collateral and self-liquidation\n.\u00a0\n\n\nAlthough there are several legitimate uses of flash loans, hackers can also use them to \nmanipulate DeFi protocols\u2019 pricing oracles\n. They do this by taking advantage of the lack of collateralization to borrow huge amounts of funds, which they can then use to manipulate token prices, typically by buying or short selling high volumes of tokens with thin supply levels.\u00a0\n\n\nHow the Euler Finance flash loan attack occurred \n\n\nWhen users borrow and lend using the Euler Finance platform, they primarily transact with two types of tokens: eTokens (which represent collateral) and dTokens (which represent debt). Euler issues eTokens based on the types of funds deposited by users; dTokens \nautomatically trigger on-chain liquidation\n when the platform holds more dTokens than eTokens.\u00a0\n\n\nThe hack was made possible by a liquidity issue in the DonateToReserve function of the eToken. This function was properly burning eTokens, but not dTokens, leading to an incorrect conversion of borrowed assets to collateralized assets. Euler\u2019s hacker took advantage of these inconsistencies to create a false impression that the platform had a low amount of deposited eTokens and fake debt due to the fact that the dTokens were not burned.\n\n\nWe currently have reason to believe that there were two primary on-chain entities involved in the hack: a front-running MEV bot (using the wallet \n0x5F259D0b76665c337c6104145894F4D1D2758B8c) and the hacker\u2019s primary personal wallet (using the wallet 0xb66cd966670d962C227B3EABA30a872DbFb995db). The hacker hardcoded their lending contract so that the personal wallet received most of the funds, regardless of which entity executed which transactions.\u00a0\n\n\nThe hacker received initial funding from the \nsanctioned mixer Tornado Cash\n for gas fees and to create the contracts used in the exploit, then initiated a flash loan to borrow around $30 million in DAI from the DeFi protocol Aave. After this, the hacker deposited $20 million of that DAI into Euler\u2019s platform, receiving a similar amount in eDAI tokens. By leveraging Euler\u2019s borrowing capabilities, the hacker was able to borrow 10 times the original deposited amount. The hacker then used the remaining $10 million in DAI from the original loan to \nrepay part of the acquired debt\n (dDAI) and reused the mint function to borrow again until the flash loan was closed. After the hack was complete, the hacker moved some of the funds back to Tornado Cash. Investigators would need to employ advanced investigative techniques like those Chainalysis offers to pursue the funds further.\n\n\nWe can see some of these steps in the \nChainalysis Storyline\n graph below:\u00a0\n\n\nOpen in new tab to enlarge\n\n\nOverall, Euler lost roughly $197 million worth of cryptocurrency, spread across DAI, wBTC, stETH, and USDC. Additionally, Euler\u2019s native token, EUL, \ndeclined more than 45%\n.\u00a0\n\n\nReducing hacking risks\n\n\nAlthough it can be difficult to identify DeFi platform vulnerabilities, there may be several methods to \nmitigate risk\n of flash loan attacks to protect cryptocurrency participants from similar catastrophic events. For instance, circuit breakers could be used to temporarily halt protocols when there are unusually large price movements or outflows so that hacks can be stopped early. We will continue to monitor the Euler hack situation and provide updates as possible.\n\n\nThis material is for informational purposes only, and is not intended to provide legal, tax, financial, or investment advice. Recipients should consult their own advisors before making these types of decisions. Chainalysis has no responsibility or liability for any decision made or any other acts or omissions in connection with Recipient\u2019s use of this material.\n\n\nChainalysis does not guarantee or warrant the accuracy, completeness, timeliness, suitability or validity of the information in this report and will not be responsible for any claim attributable to errors, omissions, or other inaccuracies of any part of such material.\n\n\n\n"
    }
}